      *=======================*                                          R09039#
       IDENTIFICATION DIVISION.                                          R09039#
      *=======================*                                          R09039#
       PROGRAM-ID.    SMF110S1.                                          R09039#
       AUTHOR.        KANG DENGSONG.                                     R09039#
       DATE-WRITTEN.  Feb 08,2009.                                       R09039#
      *================================================================* R09039#
      *  CREATE DATE: Feb 08,2009                                      * R09039#
      *  AUTHOR     : KANG DENGSONG                                    * R09039#
      *  VERSION    : V1.00                                            * R09039#
      *================================================================* R09039#
      *PLS ADD OPTION AR(E) WHEN YOU COMPILE IT.*                      * R09039#
      *THIS PROGRAM IS TO EXTRACT DATA WHEN TYPE=110(1) FROM SMF       * R09039#
      *WILL EXTRACT BELOW SECTION:                                     * R09039#
      *  1,HEADER/SELF-DEFINING SECTION                                * R09039#
      *  2,SMF PRODUCT SECTION                                         * R09039#
      *  3,DATA SECTIONS                                               * R09039#
      *================================================================* R09039#
      *================================================================* R09039#
      * change Log                                                     * R09039#
      *================================================================* R09039#
      *  Logno      mender               Desc                          * R09039#
      *----------------------------------------------------------------* R09039#
      * R09039#     Kangdengsong        INITIAL VERSION                * R09039#
      *================================================================* R09039#
      *=====================*                                            R09039#
       ENVIRONMENT DIVISION.                                             R09039#
      *=====================*                                            R09039#
       CONFIGURATION SECTION.                                            R09039#
       SOURCE-COMPUTER. IBM-ES9000.                                      R09039#
       OBJECT-COMPUTER. IBM-ES9000.                                      R09039#
       INPUT-OUTPUT SECTION.                                             R09039#
       FILE-CONTROL.                                                     R09039#
           SELECT SMF110IN  ASSIGN         TO SMF110IN                   R09039#
                            ORGANIZATION   IS SEQUENTIAL                 R09039#
                            ACCESS MODE    IS SEQUENTIAL                 R09039#
                            FILE STATUS    IS WS-SMFIN-ST.               R09039#
      *    SELECT SMF110OP  ASSIGN         TO SMF110OP                   R09039#
      *                     ORGANIZATION   IS SEQUENTIAL                 R09039#
      *                     ACCESS MODE    IS SEQUENTIAL                 R09039#
      *                     FILE STATUS    IS WS-SMFOUT-ST.              R09039#
           SELECT SMF110MN  ASSIGN         TO SMF110MN                   R09039#
                            ORGANIZATION   IS SEQUENTIAL                 R09039#
                            ACCESS MODE    IS SEQUENTIAL                 R09039#
                            FILE STATUS    IS WS-SMF110MN-ST.            R09039#
      *=============*                                                    R09039#
       DATA DIVISION.                                                    R09039#
      *=============*                                                    R09039#
       FILE SECTION.                                                     R09039#
       FD  SMF110IN                                                      R09039#
           RECORDING MODE IS V                                           R09039#
           RECORD CONTAINS 154 TO 32752 CHARACTERS                       R09039#
           BLOCK CONTAINS 0 CHARACTERS.                                  R09039#
       01  SMF110IN-REC.                                                 R09039#
           05 SMF110IN-X PIC  X(01)  OCCURS 154 TO 32752 TIMES           R09039#
              DEPENDING ON  WS-SMFIN-LEN.                                R09039#
      *                                                                  R09039#
      *FD  SMF110OP.                                                     R09039#
      *01  CICS-PE-RECORD.                                               R09039#
      *    COPY CICSDAT2.                                                R09039#
       FD  SMF110MN.                                                     R09039#
       01  SMF110MN-RPT                    PIC X(153).                   R09039#
      *    COPY SMF110MN.                                                R09039#
      *                                                                  R09039#
                                                                         R09039#
       WORKING-STORAGE SECTION.                                          R09039#
       01  FILLER                          PIC X(50) VALUE               R09039#
              'SMF110S1 WORKING STORAGE START HERE'.                     R09039#
       01  WS-SW.                                                        R09039#
           05 WS-WHEN-COMPILED             PIC X(22) VALUE SPACE.        R09039#
           05 WS-BINARY-3                  PIC 9(09)  COMP VALUE ZERO.   R09039#
           05 FILLER REDEFINES WS-BINARY-3.                              R09039#
              10 WS-BYTE-X                 OCCURS 4 TIMES PIC X(01).     R09039#
TSTKDS     05 WS-TEST                      PIC -Z,ZZZ,Z99.99.            R09039#
           05 WS-INT-DAY                   PIC 9(08) VALUE ZERO.         R09039#
           05 WS-SYSIN1.                                                 R09039#
              10 WS-SYSIN-ST               PIC X(10) VALUE SPACE.        R09039#
                 88 PER-CICS-TRAN          VALUE  'CICS TRAN='.          R09039#
              10 WS-CICS-TRAN              PIC X(01) VALUE SPACE.        R09039#
                 88 PER-CICS-YES           VALUE  'Y'.                   R09039#
                 88 PER-CICS-NO            VALUE  'N'.                   R09039#
           05 WS-SYSIN2.                                                 R09039#
              10 WS-SYSI2-ST               PIC X(05) VALUE SPACE.        R09039#
                 88 VALID-TRAN-ST          VALUE  'TRAN='.               R09039#
              10 WS-SYS2-TRAN              PIC X(04) VALUE SPACE.        R09039#
           05 WS-SYSIN3.                                                 R09039#
              10 WS-SYS3-ST-TIME           PIC X(20) VALUE SPACE.        R09039#
           05 WS-SYSIN4.                                                 R09039#
              10 WS-SYS4-ED-TIME           PIC X(20) VALUE SPACE.        R09039#
           05 WS-MIN-PAGE-NO               PIC 9(08) VALUE ZERO.         R09039#
           05 WS-MIN-REC-NO                PIC 9(08) VALUE ZERO.         R09039#
           05 WS-MIN-IND                   PIC 9(05) VALUE ZERO.         R09039#
           05 WS-OPT-PAGE-NO               PIC 9(08) VALUE ZERO.         R09039#
           05 WS-OPT-REC-NO                PIC 9(08) VALUE ZERO.         R09039#
           05 WS-OPT-IND                   PIC 9(05) VALUE ZERO.         R09039#
           05 WS-COMP-4                    PIC 9(04) VALUE ZERO.         R09039#
           05 WS-COMP-9                    PIC 9(09) VALUE ZERO.         R09039#
           05 WS-GO-SKIP                   PIC X(01) VALUE SPACE.        R09039#
              88 WS-GO                     VALUE 'Y'.                    R09039#
              88 WS-SKIP                   VALUE 'N'.                    R09039#
           05 WS-END-EOF                   PIC X(01) VALUE SPACE.        R09039#
              88 K-END-FILE                VALUE 'Y'.                    R09039#
              88 K-X-END-FILE              VALUE 'N'.                    R09039#
           05 WS-TIME-SECOND               PIC 9(16)V99 VALUE ZERO.      R09039#
           05 WS-SIN-JOB                   PIC X(50) VALUE SPACE.        R09039#
           05 FILLER REDEFINES WS-SIN-JOB.                               R09039#
              10 WS-JOB-NAME           PIC X(08).                        R09039#
              10 WS-SIN-JOB-PLUS           PIC X(42).                    R09039#
           05 WS-I                         PIC 9(05) VALUE ZERO.         R09039#
           05 WS-J                         PIC 9(05) VALUE ZERO.         R09039#
           05 WS-KEP-POS                   PIC 9(05) VALUE 1.            R09039#
           05 OPEN-SMF110IN-FLG            PIC X(01) VALUE SPACE.        R09039#
              88 OPEN-SMF110IN-OK                    VALUE 'Y'.          R09039#
           05 OPEN-SMF110OP-FLG            PIC X(01) VALUE SPACE.        R09039#
              88 OPEN-SMF110OP-OK                    VALUE 'Y'.          R09039#
           05 OPEN-SMF110MN-FLG            PIC X(01) VALUE SPACE.        R09039#
              88 OPEN-SMF110MN-OK                    VALUE 'Y'.          R09039#
           05 WS-MODE                      PIC X(01) VALUE SPACE.        R09039#
              88 WS-PATTERN-MOD                      VALUE 'Y'.          R09039#
              88 WS-FULL-MOD                         VALUE 'N'.          R09039#
           05 WS-ST-TIME-INT               PIC 9(09) VALUE ZERO.         R09039#
           05 WS-ED-TIME-INT               PIC 9(09) VALUE ZERO.         R09039#
           05 WS-TIME-SECOND-X             PIC Z,ZZZ,Z99.99.             R09039#
           05 WS-START-POS                 PIC 9(05) VALUE ZERO.         R09039#
           05 WS-CURR-POS                  PIC 9(05) VALUE ZERO.         R09039#
           05 WS-REC-LEN                   PIC 9(05) VALUE ZERO.         R09039#
           05 WS-SMFIN-LEN                 PIC 9(08) VALUE ZERO.         R09039#
           05 WS-OFF-CICS                  PIC 9(10) COMP VALUE ZERO.    R09039#
           05 WS-RETURN-CODE               PIC 9(02) VALUE ZERO.         R09039#
           05 WS-ALL-REC-NO                PIC 9(06) VALUE ZERO.         R09039#
           05 WS-REC-NO-VALID              PIC 9(06) VALUE ZERO.         R09039#
           05 WS-REC-NO-INVALID            PIC 9(06) VALUE ZERO.         R09039#
           05 WK-MID.                                                    R09039#
              10 WK-BIN                    PIC 9(04)  BINARY.            R09039#
              10 WK-MID                    REDEFINES WK-BIN.             R09039#
                 15 WK-MID21               PIC X(01).                    R09039#
                 15 WK-MID22               PIC X(01).                    R09039#
           05 WS-TEMP-DATE-HEX             PIC X(04) VALUE ZERO.         R09039#
           05 WS-TEMP-DATE                 PIC X(07) VALUE ZERO.         R09039#
           05 FILLER REDEFINES WS-TEMP-DATE.                             R09039#
              10 WS-TEMP-DATE-YYYY         PIC X(04).                    R09039#
              10 WS-TEMP-DATE-DDD          PIC X(03).                    R09039#
           05 WS-INDEX-DT1                 PIC 9(03) VALUE ZERO.         R09039#
           05 WS-INDEX-DT2                 PIC 9(03) VALUE ZERO.         R09039#
           05 WS-INDEX-DT3                 PIC 9(03) VALUE ZERO.         R09039#
           05 WS-REC-CODE                  PIC X(04) VALUE ZERO.         R09039#
           05 WS-BIN-1                     PIC 9(04) BINARY.             R09039#
           05 WS-BIN-2                     PIC 9(04) BINARY.             R09039#
           05 WS-BIN-3                     PIC 9(04) BINARY.             R09039#
           05 WS-R1 REDEFINES WS-BIN-3.                                  R09039#
                 10 WS-R11                 PIC X(01).                    R09039#
                 10 WS-R12                 PIC X(01).                    R09039#
           05 WS-K                         PIC 9(10) VALUE ZERO.         R09039#
           05 WS-TOT-TIME                  PIC ZZ,ZZZ,ZZZ,ZZZ.99.        R09039#
           05 WS-SMFIN-EOF-SW              PIC X VALUE 'N'.              R09039#
               88 SW-SMFIN-EOF                   VALUE 'Y'.              R09039#
               88 SW-SMFIN-NOT-EOF               VALUE 'N'.              R09039#
           05 WS-RPT-EOF-SW                PIC X VALUE 'N'.              R09039#
               88 SW-RPT-EOF                     VALUE 'Y'.              R09039#
               88 SW-RPT-NOT-EOF                 VALUE 'N'.              R09039#
           05  STAMPCON-PARM               PIC X(40).                    R09039#
           05  FILLER REDEFINES STAMPCON-PARM.                           R09039#
               15  INPUT-TIME              PIC X(08).                    R09039#
               15  INPUT-TIME1             PIC X(32).                    R09039#
           05 WS-COM.                                                    R09039#
              10 BEGIN-TIME                PIC X(20).                    R09039#
              10 END-TIME                  PIC X(20).                    R09039#
              10 COST-TIME                 PIC 9(12)V999999.             R09039#
              10 RC                        PIC 9(02).                    R09039#
              10 RC-MSG                    PIC X(50).                    R09039#
       01 WS-FILE-STATUS.                                                R09039#
           05 WS-SMFIN-ST                  PIC 9(02) VALUE 0.            R09039#
           05 WS-PRT-ST                    PIC 9(02) VALUE 0.            R09039#
           05 WS-SMFOUT-ST                 PIC 9(02) VALUE 0.            R09039#
           05 WS-SMF110MN-ST               PIC 9(02) VALUE 0.            R09039#
       01 WS-YYYYMMDD                      PIC X(8) VALUE SPACE.         R09039#
       01 FILLER         REDEFINES WS-YYYYMMDD.                          R09039#
          03 WS-CCYY                       PIC X(04).                    R09039#
          03 WS-MMMM                       PIC X(02).                    R09039#
          03 WS-DDDD                       PIC X(02).                    R09039#
       01 SMFS1TO8-AREA                    PIC X(128).                   R09039#
       01 SMFS1TO8                         PIC X(08) VALUE 'SMFS1TO8'.   R09039#
       77 K-1M                             PIC 9(07) VALUE 1000000.      R09039#
       77 K-ONE-1K                         PIC 9(05) VALUE 1024.         R09039#
       77 K-OFF                            PIC 9(05) VALUE 3.            R09039#
       77 K-NULL-DATE                      PIC X(04) VALUE X'0000000F'.  R09039#
       77 K-LOW-VALUE                      PIC X(01) VALUE X'00'.        R09039#
       77 K-NINE                           PIC X(01) VALUE X'09'.        R09039#
       77 K-TEST-REC-NO                    PIC 9(07) VALUE 9999999.      R09039#
       01 K-MSG.                                                         R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             'Remark:'.                                                  R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '1,All time unit is second,memory unit is bytes'.           R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '2,Susp. time including:'.                                  R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,1 TC I/O wait time'.                                    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,2 JC I/O wait time                     '.               R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,3 TS I/O wait time                     '.               R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,4 FC I/O wait time                     '.               R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,5 FC IR I/O wait time                       '.          R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,6 TD I/O wait time                              '.      R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,7 Lock Manager delay time '.                            R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,8 Local ENQ delay time '.                               R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,9 TC I/O wait time - LU6.1 '.                           R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,10 TC I/O wait time - LU6.2 '.                          R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,11 FEPI Suspend time '.                                 R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,12 Resource manager interface (RMI) suspend time'.      R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,13 RLS FC I/O wait time '.                              R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,14 CF data tables server I/O wait time'.                R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,15 CF data tables syncpoint and resyn. wait time '.     R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,16 Shared TS I/O wait time '.                           R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,17 EXEC CICS WAIT EXTERNAL wait time '.                 R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,18 EXEC CICS WAITCICS and WAIT EVENT wait time'.        R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,19 Interval Control delay time'.                        R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,20 Dispatchable Wait wait time'.                        R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,21 IMS (DBCTL) wait time'.                              R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,22 DB2 ready queue wait time'.                          R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,23 DB2 connection time'.                                R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,24 DB2 wait time'.                                      R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,25 RRMS/MVS wait time'.                                 R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,26 Request Receiver wait time '.                        R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,27 Request Processor wait time '.                       R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,28 CICS BTS run process/activity synchronous wait '.    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,29 Syncpoint delay time '.                              R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,30 Inbound Socket I/O wait time '.                      R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,31 CICS MAXOPENTCBS delay time '.                       R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,32 Java Virtual Machine (JVM) suspend time '.           R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,33 CICS MAXJVMTCBS delay time '.                        R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,34 CICS MAXHPTCBS delay time '.                         R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,35 3270 bridge partner wait time '.                     R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,36 Outbound Socket I/O wait time '.                     R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' 2,37 Global ENQ delay time         '.                     R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '3,CICS TCB time:                   '.                      R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' Processor time for which the user task was dispatched'.   R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' CICS TCB under which the task executed.This can include'. R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' modes QR,RO, CO,FO, SZ, RP, SL, SO, H8, J8, L8, S8 and'.  R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' D2'.                                                      R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '4,Org AB: Original abend code.       '.                    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '5,Org AB: Current abend code.        '.                    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '6,Memory(Max):                       '.                    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '  Maximum amount (high-water mark) of program storage in'. R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '  use by the user task both above and below the 16MB'.     R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '  line.'.                                                  R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '7,St ty :Transaction start type      '.                    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '8,Stat time :Transaction start time  '.                    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '9,End time :Transaction end time  '.                       R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '10,File wait :Total file wait time  '.                     R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             '11,File cnt  :Wait appear time      '.                     R09039#
         03 FILLER                           PIC X(60) VALUE SPACE.      R0R0903
         03 FILLER                           PIC X(60) VALUE             R0R0903
             'PLS contact me if you have any problem or suggestion.'.    R09039#
         03 FILLER                           PIC X(60) VALUE             R0R0903
             ' Kevin es9000@126.com.                               '.    R09039#
       01 K-MSG-R REDEFINES K-MSG.                                       R09039#
         03 K-MSG-A                          OCCURS 57 TIMES PIC X(60).  R09039#
           COPY DFHSMFDS.                                                R09039#
           COPY CICSDAT1.                                                R09039#
           COPY CICSDAT2.                                                R09039#
      *    COPY SMF110OP.                                                R09039#
           COPY SMF110MN.                                                R09039#
                                                                         R09039#
      *===============*                                                  R09039#
       LINKAGE SECTION.                                                  R09039#
      *===============*                                                  R09039#
      *01  PARM-INPUT.                                                   R09039#
      *    03  PARM-LENTH                      PIC 9(4) COMP.            R09039#
      *    03  PARM                            PIC X(40).                R09039#
       PROCEDURE DIVISION.                                               R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       0000-MAIN-ROUTINE.                                                R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           PERFORM A000-OPEN-FILES    THRU  A000-EXIT                    R09039#
           PERFORM A200-FORMAT-SMF110 THRU A200-EXIT                     R09039#
           PERFORM 9800-CLOSE-FILES   THRU  9800-EXIT.                   R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       0000-EXIT.                                                        R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           GOBACK.                                                       R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       A000-OPEN-FILES.                                                  R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
            MOVE FUNCTION  WHEN-COMPILED     TO WS-WHEN-COMPILED         R09039#
TSTKDS      DISPLAY 'SMF110S1 BEGIN  COMPILE TIME=' WS-WHEN-COMPILED
            ACCEPT WS-YYYYMMDD FROM DATE YYYYMMDD                        R09039#
            MOVE WS-CCYY                    TO SMF110-MIN-DATE-YYYY      R09039#
            MOVE WS-MMMM                    TO SMF110-MIN-DATE-MM        R09039#
            MOVE WS-DDDD                    TO SMF110-MIN-DATE-DD        R09039#
      *     MOVE WS-CCYY                    TO SMF110-OPT-DATE-YYYY      R09039#
      *     MOVE WS-MMMM                    TO SMF110-OPT-DATE-MM        R09039#
      *     MOVE WS-DDDD                    TO SMF110-OPT-DATE-DD        R09039#
            ACCEPT WS-SYSIN1                                             R09039#
            IF NOT PER-CICS-TRAN                                         R09039#
              DISPLAY 'THE STATMENT SHOULD BE  CICS TRAN= '              R09039#
              MOVE  09                          TO WS-RETURN-CODE        R09039#
              PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT           R09039#
            END-IF                                                       R09039#
            IF NOT PER-CICS-YES AND NOT PER-CICS-NO                      R09039#
              DISPLAY 'THE STATMENT SHOULD BE Y OR N ' WS-CICS-TRAN      R09039#
              MOVE  09                          TO WS-RETURN-CODE        R09039#
              PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT           R09039#
            END-IF                                                       R09039#
            ACCEPT WS-SYSIN2                                             R09039#
            IF NOT VALID-TRAN-ST                                         R09039#
              DISPLAY 'THE STATMENT SHOULD BE  TRAN= '                   R09039#
              MOVE  09                          TO WS-RETURN-CODE        R09039#
              PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT           R09039#
            END-IF                                                       R09039#
            IF WS-SYS2-TRAN(1:1) NOT = '*'                               R09039#
            THEN                                                         R09039#
               MOVE 1                           TO WS-I                  R09039#
               PERFORM  UNTIL WS-I > 4                                   R09039#
                  IF WS-SYS2-TRAN(WS-I:1) = '*'                          R09039#
                     COMPUTE WS-KEP-POS = WS-I                           R09039#
                     COMPUTE WS-KEP-POS = WS-KEP-POS - 1                 R09039#
                     COMPUTE WS-I = 5                                    R09039#
                  END-IF                                                 R09039#
                  COMPUTE WS-I = WS-I + 1                                R09039#
               END-PERFORM                                               R09039#
            END-IF                                                       R09039#
            IF WS-KEP-POS > 1                                            R09039#
               SET WS-PATTERN-MOD           TO TRUE                      R09039#
            ELSE                                                         R09039#
               SET WS-FULL-MOD              TO TRUE                      R09039#
            END-IF                                                       R09039#
            ACCEPT WS-SYSIN3                                             R09039#
            INSPECT WS-SYS3-ST-TIME  REPLACING ALL LOW-VALUES BY SPACES. R09039#
            INSPECT WS-SYS3-ST-TIME  REPLACING ALL SPACES BY ZEROS.      R09039#
            ACCEPT WS-SYSIN4                                             R09039#
            INSPECT WS-SYS4-ED-TIME  REPLACING ALL LOW-VALUES BY SPACES. R09039#
            INSPECT WS-SYS4-ED-TIME  REPLACING ALL SPACES BY ZEROS.      R09039#
            OPEN INPUT SMF110IN                                          R09039#
            IF WS-SMFIN-ST NOT = 00                                      R09039#
              DISPLAY 'OPEN SMF110IN FILE FAIL=' WS-SMFIN-ST             R09039#
              MOVE  WS-SMFIN-ST                 TO WS-RETURN-CODE        R09039#
              PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT           R09039#
            ELSE                                                         R09039#
              SET OPEN-SMF110IN-OK              TO TRUE                  R09039#
            END-IF                                                       R09039#
            OPEN OUTPUT SMF110OP                                         R09039#
            IF WS-SMFOUT-ST NOT = 00                                     R09039#
              MOVE  WS-SMFOUT-ST                TO WS-RETURN-CODE        R09039#
              DISPLAY 'OPEN SMFOUT01 FILE FAIL=' WS-SMFOUT-ST            R09039#
              PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT           R09039#
            ELSE                                                         R09039#
              SET OPEN-SMF110OP-OK              TO TRUE                  R09039#
            END-IF                                                       R09039#
            OPEN OUTPUT SMF110MN                                         R09039#
            IF WS-SMF110MN-ST NOT = 00                                   R09039#
              MOVE  WS-SMF110MN-ST               TO WS-RETURN-CODE       R09039#
              DISPLAY 'OPEN SMF110MN FILE FAIL=' WS-SMFOUT-ST            R09039#
              PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT           R09039#
            ELSE                                                         R09039#
              SET OPEN-SMF110MN-OK              TO TRUE                  R09039#
            END-IF                                                       R09039#
            EXIT.                                                        R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       A000-EXIT.                                                        R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       A200-FORMAT-SMF110.                                               R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           COMPUTE WS-ALL-REC-NO = 0                                     R09039#
           COMPUTE WS-REC-NO-VALID = 0                                   R09039#
           COMPUTE WS-MIN-PAGE-NO  = 0                                   R09039#
           COMPUTE WS-MIN-REC-NO   = 0                                   R09039#
           COMPUTE WS-MIN-IND      = 0                                   R09039#
           PERFORM P100-PRINT-MIN-HEAD                                   R09039#
           PERFORM R100-READ-SMF110IN                                    R09039#
           PERFORM UNTIL K-END-FILE OR WS-ALL-REC-NO > K-TEST-REC-NO     R09039#
              MOVE SMF110IN-REC(1:(LENGTH OF DFHSMFDS)) TO DFHSMFDS      R09039#
              ADD 1                TO WS-ALL-REC-NO                      R09039#
              COMPUTE WS-SMFIN-LEN = SMF-DS-OFFSET - 3 - 1               R09039#
                                   + SMF-DS-LENGTH                       R09039#
      *       DISPLAY 'WS-SMFIN-LEN=' WS-SMFIN-LEN                       R09039#
      *       DISPLAY 'SMF-RECORD-TYPE=' SMF-RECORD-TYPE                 R09039#
      *       DISPLAY 'SMF-RECORD-SUBTYPE=' SMF-RECORD-SUBTYPE           R09039#
      *       DISPLAY 'SMF-DS-TYPE =' SMF-DS-TYPE                        R09039#
              IF SMF-CICS-RECORD-TYPE AND                                R09039#
                 SMF-MN-SUBTYPE AND SMF-PERFORM                          R09039#
              THEN                                                       R09039#
                 IF SMF-DEFAULT-DICT                                     R09039#
                    PERFORM B100-SMF110-SUB1-PERFORM                     R09039#
                    COMPUTE WS-REC-NO-VALID = WS-REC-NO-VALID + 1        R09039#
                 ELSE                                                    R09039#
                    DISPLAY 'ONLY SUPPORT DEFAULT DICTIONARY'            R09039#
                    MOVE   4           TO WS-RETURN-CODE                 R09039#
      *             EXPAND LATER                                         R09039#
                 END-IF                                                  R09039#
              ELSE                                                       R09039#
                 IF SMF-CICS-RECORD-TYPE AND                             R09039#
                    SMF-MN-SUBTYPE AND SMF-EXCEPT                        R09039#
                 THEN                                                    R09039#
      *             EXPAND LATER(EXCEPTION REPORT)                       R09039#
                    DISPLAY 'EXCEPTION DATA INGORE'                      R09039#
                    CONTINUE                                             R09039#
                 END-IF                                                  R09039#
              END-IF                                                     R09039#
              PERFORM R100-READ-SMF110IN                                 R09039#
           END-PERFORM                                                   R09039#
           COMPUTE WS-REC-NO-INVALID = WS-ALL-REC-NO -                   R09039#
                                       WS-REC-NO-VALID                   R09039#
           IF WS-MIN-IND + 8 >= 64                                       R09039#
              PERFORM P100-PRINT-MIN-HEAD                                R09039#
           ELSE                                                          R09039#
              MOVE WS-MIN-REC-NO               TO RPT-REC-NO             R09039#
              WRITE SMF110MN-RPT  FROM SMF110-MIN-S1 AFTER 5             R09039#
              ADD  5                           TO WS-MIN-IND             R09039#
              WRITE SMF110MN-RPT  FROM SMF110-MIN-S2 AFTER 3             R09039#
              ADD  3                           TO WS-MIN-IND             R09039#
           END-IF                                                        R09039#
           PERFORM P200-PRINT-MIN-REMK                                   R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       A200-EXIT.                                                        R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *=========================*                                        R09039#
       B100-SMF110-SUB1-PERFORM.                                         R09039#
      *=========================*                                        R09039#
      *                                                                  R09039#
           COMPUTE WS-I = 1                                              R09039#
           COMPUTE WS-OFF-CICS = SMF-OFF-1ST-CICS-DATA - K-OFF           R09039#
           PERFORM UNTIL WS-I > SMF-NO-CICS-DATA                         R09039#
              MOVE SMF110IN-REC(WS-OFF-CICS:SMF-LEN-PE-SECT)             R09039#
                TO CICS-PE-RECORD                                        R09039#
              SET WS-SKIP                    TO TRUE                     R09039#
              MOVE DS-PE-CICS-START          TO INPUT-TIME               R09039#
              CALL 'STAMPCON' USING STAMPCON-PARM                        R09039#
              MOVE STAMPCON-PARM             TO CICS-START BEGIN-TIME    R09039#
              MOVE DS-PE-CICS-STOP           TO INPUT-TIME               R09039#
              CALL 'STAMPCON' USING STAMPCON-PARM                        R09039#
              MOVE STAMPCON-PARM              TO CICS-STOP  END-TIME     R09039#
              PERFORM P300-CHECK-GO-OR-SKIP                              R09039#
TSTKDS*    DISPLAY '1TASK-TRAN=' DS-PE-TASK-TRAN ':' DS-PE-TASK-TRANNUM  R09039#
TSTKDS*      ' BEGIN-TIME=' BEGIN-TIME ' END-TIME=' BEGIN-TIME           R09039#
              IF WS-GO                                                   R09039#
              THEN                                                       R09039#
                 PERFORM E100-MOVE-TO-GROUP                              R09039#
                 PERFORM E200-PRINT-MIN-REPORT                           R09039#
      *          PERFORM R200-WRITE-SMF110OP                             R09039#
              END-IF                                                     R09039#
              COMPUTE WS-OFF-CICS = WS-OFF-CICS + SMF-LEN-PE-SECT        R09039#
              COMPUTE WS-I = WS-I + 1                                    R09039#
           END-PERFORM                                                   R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *============================*                                     R09039#
       E100-MOVE-TO-GROUP.                                               R09039#
      *===========================*                                      R09039#
           MOVE DS-PE-CICS-CFCAPICT        TO CICS-CFCAPICT              R09039#
           COMPUTE CICS-EXWTTIME-P1 = DS-PE-CICS-EXWTTIME-P1 * 16 / K-1M R09039#
           MOVE DS-PE-CICS-EXWTTIME-P2     TO CICS-EXWTTIME-P2           R09039#
           MOVE DS-PE-CICS-PERRECNT        TO CICS-PERRECNT              R09039#
           MOVE DS-PE-CICS-RPTCLSNM        TO CICS-RPTCLSNM              R09039#
           MOVE DS-PE-CICS-RSYSID          TO CICS-RSYSID                R09039#
           MOVE DS-PE-CICS-RTYPE           TO CICS-RTYPE                 R09039#
           MOVE DS-PE-CICS-SRVCLSNM        TO CICS-SRVCLSNM              R09039#
           CALL 'PBCALTIM' USING WS-COM                                  R09039#
           MOVE COST-TIME                  TO CICS-COST                  R09039#
           MOVE DS-PE-CICS-USERID          TO CICS-USERID                R09039#
           COMPUTE DATA-DB2CONWT-P1 = DS-PE-DATA-DB2CONWT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-DATA-DB2CONWT-P2     TO DATA-DB2CONWT-P2           R09039#
           COMPUTE DATA-DB2RDYQW-P1 = DS-PE-DATA-DB2RDYQW-P1 * 16 / K-1M R09039#
           MOVE DS-PE-DATA-DB2RDYQW-P2     TO DATA-DB2RDYQW-P2           R09039#
           MOVE DS-PE-DATA-DB2REQCT        TO DATA-DB2REQCT              R09039#
           COMPUTE DATA-DB2WAIT-P1  = DS-PE-DATA-DB2WAIT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-DATA-DB2WAIT-P2      TO DATA-DB2WAIT-P2            R09039#
           MOVE DS-PE-DATA-IMSREQCT        TO DATA-IMSREQCT              R09039#
           COMPUTE DATA-IMSWAIT-P1  = DS-PE-DATA-IMSWAIT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-DATA-IMSWAIT-P2      TO DATA-IMSWAIT-P2            R09039#
           MOVE DS-PE-DEST-TDGETCT         TO DEST-TDGETCT               R09039#
           COMPUTE DEST-TDIOWTT-P1  = DS-PE-DEST-TDIOWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-DEST-TDIOWTT-P2      TO DEST-TDIOWTT-P2            R09039#
           MOVE DS-PE-DEST-TDPURCT         TO DEST-TDPURCT               R09039#
           MOVE DS-PE-DEST-TDPUTCT         TO DEST-TDPUTCT               R09039#
           MOVE DS-PE-DEST-TDTOTCT         TO DEST-TDTOTCT               R09039#
           COMPUTE FILE-CFDTWAIT-P1 = DS-PE-FILE-CFDTWAIT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-FILE-CFDTWAIT-P2     TO FILE-CFDTWAIT-P2           R09039#
           MOVE DS-PE-FILE-FCADDCT         TO FILE-FCADDCT               R09039#
           MOVE DS-PE-FILE-FCAMCT          TO FILE-FCAMCT                R09039#
           MOVE DS-PE-FILE-FCBRWCT         TO FILE-FCBRWCT               R09039#
           MOVE DS-PE-FILE-FCDELCT         TO FILE-FCDELCT               R09039#
           MOVE DS-PE-FILE-FCGETCT         TO FILE-FCGETCT               R09039#
           COMPUTE FILE-FCIOWTT-P1  = DS-PE-FILE-FCIOWTT-P1 * 16 / K-1M  R09039#
           MOVE DS-PE-FILE-FCIOWTT-P2      TO FILE-FCIOWTT-P2            R09039#
           MOVE DS-PE-FILE-FCPUTCT         TO FILE-FCPUTCT               R09039#
           MOVE DS-PE-FILE-FCTOTCT         TO FILE-FCTOTCT               R09039#
           COMPUTE FILE-RLSCPUT-P1  = DS-PE-FILE-RLSCPUT-P1 * 16 / K-1M  R09039#
           MOVE DS-PE-FILE-RLSCPUT-P2      TO FILE-RLSCPUT-P2            R09039#
           COMPUTE FILE-RLSWAIT-P1  = DS-PE-FILE-RLSWAIT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-FILE-RLSWAIT-P2      TO FILE-RLSWAIT-P2            R09039#
           COMPUTE JOUR-JCIOWTT-P1  = DS-PE-JOUR-JCIOWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-JOUR-JCIOWTT-P2      TO JOUR-JCIOWTT-P2            R09039#
           MOVE DS-PE-JOUR-JNLWRTCT        TO JOUR-JNLWRTCT              R09039#
           MOVE DS-PE-JOUR-LOGWRTCT        TO JOUR-LOGWRTCT              R09039#
           MOVE DS-PE-MAPP-BMSINCT         TO MAPP-BMSINCT               R09039#
           MOVE DS-PE-MAPP-BMSMAPCT        TO MAPP-BMSMAPCT              R09039#
           MOVE DS-PE-MAPP-BMSOUTCT        TO MAPP-BMSOUTCT              R09039#
           MOVE DS-PE-MAPP-BMSTOTCT        TO MAPP-BMSTOTCT              R09039#
           IF DS-PE-PROG-ABCODEC NOT = LOW-VALUE                         R09039#
              MOVE DS-PE-PROG-ABCODEC      TO PROG-ABCODEC               R09039#
           ELSE                                                          R09039#
              MOVE SPACE                   TO PROG-ABCODEC               R09039#
           END-IF                                                        R09039#
           IF DS-PE-PROG-ABCODEO NOT = LOW-VALUE                         R09039#
              MOVE DS-PE-PROG-ABCODEO      TO PROG-ABCODEO               R09039#
           ELSE                                                          R09039#
              MOVE SPACE                   TO PROG-ABCODEO               R09039#
           END-IF                                                        R09039#
           MOVE DS-PE-PROG-PCDPLCT         TO PROG-PCDPLCT               R09039#
           MOVE DS-PE-PROG-PCLINKCT        TO PROG-PCLINKCT              R09039#
           MOVE DS-PE-PROG-PCLOADCT        TO PROG-PCLOADCT              R09039#
           COMPUTE PROG-PCLOADTM-P1 = DS-PE-PROG-PCLOADTM-P1 * 16 / K-1M R09039#
           MOVE DS-PE-PROG-PCLOADTM-P2     TO PROG-PCLOADTM-P2           R09039#
           MOVE DS-PE-PROG-PCLURMCT        TO PROG-PCLURMCT              R09039#
           MOVE DS-PE-PROG-PCXCTLCT        TO PROG-PCXCTLCT              R09039#
           MOVE DS-PE-PROG-PGMNAME         TO PROG-PGMNAME               R09039#
           MOVE DS-PE-SOCK-CLIPADDR        TO SOCK-CLIPADDR              R09039#
           MOVE DS-PE-SOCK-PORTNUM         TO SOCK-PORTNUM               R09039#
           MOVE DS-PE-SOCK-SOBYDECT        TO SOCK-SOBYDECT              R09039#
           MOVE DS-PE-SOCK-SOBYENCT        TO SOCK-SOBYENCT              R09039#
           MOVE DS-PE-SOCK-SOCHRIN         TO SOCK-SOCHRIN               R09039#
           MOVE DS-PE-SOCK-SOCHRIN1        TO SOCK-SOCHRIN1              R09039#
           MOVE DS-PE-SOCK-SOCHROU1        TO SOCK-SOCHROU1              R09039#
           MOVE DS-PE-SOCK-SOCHROUT        TO SOCK-SOCHROUT              R09039#
           MOVE DS-PE-SOCK-SOCNPSCT        TO SOCK-SOCNPSCT              R09039#
           MOVE DS-PE-SOCK-SOCPSCT         TO SOCK-SOCPSCT               R09039#
           MOVE DS-PE-SOCK-SOEXTRCT        TO SOCK-SOEXTRCT              R09039#
           COMPUTE SOCK-SOIOWTT-P1  = DS-PE-SOCK-SOIOWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-SOCK-SOIOWTT-P2      TO SOCK-SOIOWTT-P2            R09039#
           MOVE DS-PE-SOCK-SOMSGIN1        TO SOCK-SOMSGIN1              R09039#
           MOVE DS-PE-SOCK-SOMSGOU1        TO SOCK-SOMSGOU1              R09039#
           MOVE DS-PE-SOCK-SONPSHWM        TO SOCK-SONPSHWM              R09039#
           COMPUTE SOCK-SOOIOWTT-P1 = DS-PE-SOCK-SOOIOWTT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-SOCK-SOOIOWTT-P2     TO SOCK-SOOIOWTT-P2           R09039#
           MOVE DS-PE-SOCK-SOPSHWM         TO SOCK-SOPSHWM               R09039#
           MOVE DS-PE-SOCK-SORCVCT         TO SOCK-SORCVCT               R09039#
           MOVE DS-PE-SOCK-SOSENDCT        TO SOCK-SOSENDCT              R09039#
           MOVE DS-PE-SOCK-SOTOTCT         TO SOCK-SOTOTCT               R09039#
           MOVE DS-PE-SOCK-TCPSRVCE        TO SOCK-TCPSRVCE              R09039#
           MOVE DS-PE-STOR-PC24BHWM        TO STOR-PC24BHWM              R09039#
           MOVE DS-PE-STOR-PC24CHWM        TO STOR-PC24CHWM              R09039#
           MOVE DS-PE-STOR-PC24RHWM        TO STOR-PC24RHWM              R09039#
           MOVE DS-PE-STOR-PC24SHWM        TO STOR-PC24SHWM              R09039#
           MOVE DS-PE-STOR-PC31AHWM        TO STOR-PC31AHWM              R09039#
           MOVE DS-PE-STOR-PC31CHWM        TO STOR-PC31CHWM              R09039#
           MOVE DS-PE-STOR-PC31RHWM        TO STOR-PC31RHWM              R09039#
           MOVE DS-PE-STOR-PC31SHWM        TO STOR-PC31SHWM              R09039#
           MOVE DS-PE-STOR-PCSTGHWM        TO STOR-PCSTGHWM              R09039#
           MOVE DS-PE-STOR-SC24CHWM        TO STOR-SC24CHWM              R09039#
           MOVE DS-PE-STOR-SC24COCC        TO STOR-SC24COCC              R09039#
           MOVE DS-PE-STOR-SC24FSHR        TO STOR-SC24FSHR              R09039#
           MOVE DS-PE-STOR-SC24GSHR        TO STOR-SC24GSHR              R09039#
           MOVE DS-PE-STOR-SC24SGCT        TO STOR-SC24SGCT              R09039#
           MOVE DS-PE-STOR-SC31CHWM        TO STOR-SC31CHWM              R09039#
           MOVE DS-PE-STOR-SC31COCC        TO STOR-SC31COCC              R09039#
           MOVE DS-PE-STOR-SC31FSHR        TO STOR-SC31FSHR              R09039#
           MOVE DS-PE-STOR-SC31GSHR        TO STOR-SC31GSHR              R09039#
           MOVE DS-PE-STOR-SC31SGCT        TO STOR-SC31SGCT              R09039#
           MOVE DS-PE-STOR-SCCGETCT        TO STOR-SCCGETCT              R09039#
           MOVE DS-PE-STOR-SCCGETCT-E      TO STOR-SCCGETCT-E            R09039#
           MOVE DS-PE-STOR-SCUCRSTG        TO STOR-SCUCRSTG              R09039#
           MOVE DS-PE-STOR-SCUGETCT        TO STOR-SCUGETCT              R09039#
           MOVE DS-PE-STOR-SCUGETCT-E      TO STOR-SCUGETCT-E            R09039#
           MOVE DS-PE-STOR-SCUSRHWM        TO STOR-SCUSRHWM              R09039#
           MOVE DS-PE-STOR-SCUSRHWM-E      TO STOR-SCUSRHWM-E            R09039#
           MOVE DS-PE-STOR-SCUSRSTG        TO STOR-SCUSRSTG              R09039#
           COMPUTE SYNC-OTSINDWT-P1 = DS-PE-SYNC-OTSINDWT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-SYNC-OTSINDWT-P2     TO SYNC-OTSINDWT-P2           R09039#
           MOVE DS-PE-SYNC-SPSYNCCT        TO SYNC-SPSYNCCT              R09039#
           COMPUTE SYNC-SRVSYWTT-P1 = DS-PE-SYNC-SRVSYWTT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-SYNC-SRVSYWTT-P2     TO SYNC-SRVSYWTT-P2           R09039#
           COMPUTE SYNC-SYNCDLY-P1  = DS-PE-SYNC-SYNCDLY-P1  * 16 / K-1M R09039#
           MOVE DS-PE-SYNC-SYNCDLY-P2      TO SYNC-SYNCDLY-P2            R09039#
           COMPUTE SYNC-SYNCTIME-P1 = DS-PE-SYNC-SYNCTIME-P1 * 16 / K-1M R09039#
           MOVE DS-PE-SYNC-SYNCTIME-P2     TO SYNC-SYNCTIME-P2           R09039#
           MOVE DS-PE-TASK-BRDGTRAN        TO TASK-BRDGTRAN              R09039#
           MOVE DS-PE-TASK-CHMODECT        TO TASK-CHMODECT              R09039#
           COMPUTE TASK-DISPWTT-P1  = DS-PE-TASK-DISPWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-DISPWTT-P2      TO TASK-DISPWTT-P2            R09039#
           COMPUTE TASK-DSPDELAY-P1 = DS-PE-TASK-DSPDELAY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-DSPDELAY-P2     TO TASK-DSPDELAY-P2           R09039#
           COMPUTE TASK-ENQDELAY-P1 = DS-PE-TASK-ENQDELAY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-ENQDELAY-P2     TO TASK-ENQDELAY-P2           R09039#
           MOVE DS-PE-TASK-FCTYNAME        TO TASK-FCTYNAME              R09039#
           COMPUTE TASK-GNQDELAY-P1 = DS-PE-TASK-GNQDELAY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-GNQDELAY-P2     TO TASK-GNQDELAY-P2           R09039#
           COMPUTE TASK-GVUPWAIT-P1 = DS-PE-TASK-GVUPWAIT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-GVUPWAIT-P2     TO TASK-GVUPWAIT-P2           R09039#
           COMPUTE TASK-ICDELAY-P1  = DS-PE-TASK-ICDELAY-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-ICDELAY-P2      TO TASK-ICDELAY-P2            R09039#
           MOVE DS-PE-TASK-ICPUINCT        TO TASK-ICPUINCT              R09039#
           MOVE DS-PE-TASK-ICTOTCT         TO TASK-ICTOTCT               R09039#
           COMPUTE TASK-J8CPUT-P1   = DS-PE-TASK-J8CPUT-P1   * 16 / K-1M R09039#
           MOVE DS-PE-TASK-J8CPUT-P2       TO TASK-J8CPUT-P2             R09039#
           COMPUTE TASK-JVMITIME-P1 = DS-PE-TASK-JVMITIME-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-JVMITIME-P2     TO TASK-JVMITIME-P2           R09039#
           COMPUTE TASK-JVMRTIME-P1 = DS-PE-TASK-JVMRTIME-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-JVMRTIME-P2     TO TASK-JVMRTIME-P2           R09039#
           COMPUTE TASK-JVMSUSP-P1  = DS-PE-TASK-JVMSUSP-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-JVMSUSP-P2      TO TASK-JVMSUSP-P2            R09039#
           COMPUTE TASK-JVMTIME-P1  = DS-PE-TASK-JVMTIME-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-JVMTIME-P2      TO TASK-JVMTIME-P2            R09039#
           MOVE DS-PE-TASK-KY8CPUT-P1      TO TASK-KY8CPUT-P1            R09039#
           MOVE DS-PE-TASK-KY8CPUT-P2      TO TASK-KY8CPUT-P2            R09039#
           COMPUTE TASK-KY8DISPT-P1 = DS-PE-TASK-KY8DISPT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-KY8DISPT-P2     TO TASK-KY8DISPT-P2           R09039#
           COMPUTE TASK-L8CPUT-P1   = DS-PE-TASK-L8CPUT-P1   * 16 / K-1M R09039#
           MOVE DS-PE-TASK-L8CPUT-P2       TO TASK-L8CPUT-P2             R09039#
           COMPUTE TASK-LMDELAY-P1  = DS-PE-TASK-LMDELAY-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-LMDELAY-P2      TO TASK-LMDELAY-P2            R09039#
           COMPUTE TASK-MAXHTDLY-P1 = DS-PE-TASK-MAXHTDLY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-MAXHTDLY-P2     TO TASK-MAXHTDLY-P2           R09039#
           COMPUTE TASK-MAXJTDLY-P1 = DS-PE-TASK-MAXJTDLY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-MAXJTDLY-P2     TO TASK-MAXJTDLY-P2           R09039#
           COMPUTE TASK-MAXOTDLY-P1 = DS-PE-TASK-MAXOTDLY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-MAXOTDLY-P2     TO TASK-MAXOTDLY-P2           R09039#
           COMPUTE TASK-MSCPUT-P1   = DS-PE-TASK-MSCPUT-P1   * 16 / K-1M R09039#
           MOVE DS-PE-TASK-MSCPUT-P2       TO TASK-MSCPUT-P2             R09039#
           COMPUTE TASK-MSDISPT-P1  = DS-PE-TASK-MSDISPT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-MSDISPT-P2      TO TASK-MSDISPT-P2            R09039#
           COMPUTE TASK-MXTDELAY-P1 = DS-PE-TASK-MXTDELAY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-MXTDELAY-P2     TO TASK-MXTDELAY-P2           R09039#
           MOVE DS-PE-TASK-NETUOWPX        TO TASK-NETUOWPX              R09039#
           MOVE DS-PE-TASK-NETUOWSX        TO TASK-NETUOWSX              R09039#
           MOVE DS-PE-TASK-OTSTID          TO TASK-OTSTID                R09039#
           COMPUTE TASK-PTPWAIT-P1  = DS-PE-TASK-PTPWAIT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-PTPWAIT-P2      TO TASK-PTPWAIT-P2            R09039#
           COMPUTE TASK-QRCPUT-P1   = DS-PE-TASK-QRCPUT-P1   * 16 / K-1M R09039#
           MOVE DS-PE-TASK-QRCPUT-P2       TO TASK-QRCPUT-P2             R09039#
           COMPUTE TASK-JVMSUSP-P1  = DS-PE-TASK-JVMSUSP-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-JVMSUSP-P2      TO TASK-JVMSUSP-P2            R09039#
           COMPUTE TASK-QRMODDLY-P1 = DS-PE-TASK-QRMODDLY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-QRMODDLY-P2     TO TASK-QRMODDLY-P2           R09039#
           COMPUTE TASK-RMISUSP-P1  = DS-PE-TASK-RMISUSP-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RMISUSP-P2      TO TASK-RMISUSP-P2            R09039#
           COMPUTE TASK-RMITIME-P1  = DS-PE-TASK-RMITIME-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RMITIME-P2      TO TASK-RMITIME-P2            R09039#
           MOVE DS-PE-TASK-RMUOWID         TO TASK-RMUOWID               R09039#
           COMPUTE TASK-ROCPUT-P1   = DS-PE-TASK-ROCPUT-P1   * 16 / K-1M R09039#
           MOVE DS-PE-TASK-ROCPUT-P2       TO TASK-ROCPUT-P2             R09039#
           COMPUTE TASK-RODISPT-P1  = DS-PE-TASK-RODISPT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RODISPT-P2      TO TASK-RODISPT-P2            R09039#
           COMPUTE TASK-RQPWAIT-P1  = DS-PE-TASK-RQPWAIT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RQPWAIT-P2      TO TASK-RQPWAIT-P2            R09039#
           COMPUTE TASK-RQRWAIT-P1  = DS-PE-TASK-RQRWAIT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RQRWAIT-P2      TO TASK-RQRWAIT-P2            R09039#
           MOVE DS-PE-TASK-RRMSURID        TO TASK-RRMSURID              R09039#
           COMPUTE TASK-RRMSWAIT-P1 = DS-PE-TASK-RRMSWAIT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RRMSWAIT-P2     TO TASK-RRMSWAIT-P2           R09039#
           COMPUTE TASK-RUNTRWTT-P1 = DS-PE-TASK-RUNTRWTT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-RUNTRWTT-P2     TO TASK-RUNTRWTT-P2           R09039#
           COMPUTE TASK-S8CPUT-P1   = DS-PE-TASK-S8CPUT-P1   * 16 / K-1M R09039#
           MOVE DS-PE-TASK-S8CPUT-P2       TO TASK-S8CPUT-P2             R09039#
           COMPUTE TASK-SUSPTIME-P1 = DS-PE-TASK-SUSPTIME-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-SUSPTIME-P2     TO TASK-SUSPTIME-P2           R09039#
           MOVE DS-PE-TASK-TASKFLAG        TO TASK-TASKFLAG              R09039#
           MOVE DS-PE-TASK-TCBATTCT        TO TASK-TCBATTCT              R09039#
           COMPUTE TASK-TCLDELAY-P1 = DS-PE-TASK-TCLDELAY-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-TCLDELAY-P2     TO TASK-TCLDELAY-P2           R09039#
           MOVE DS-PE-TASK-TCLSNAME        TO TASK-TCLSNAME              R09039#
           MOVE DS-PE-TASK-TRAN            TO TASK-TRAN                  R09039#
           MOVE DS-PE-TASK-TRAN            TO CICS-TRAN                  R09039#
           MOVE DS-PE-TASK-TRANFLAG        TO TASK-TRANFLAG              R09039#
           MOVE DS-PE-TASK-TRANNUM         TO TASK-TRANNUM               R09039#
           MOVE DS-PE-TASK-TRANPRI         TO TASK-TRANPRI               R09039#
           MOVE DS-PE-TASK-TRNGRPID        TO TASK-TRNGRPID              R09039#
           MOVE DS-PE-TASK-TTYPE           TO TASK-TTYPE                 R09039#
           COMPUTE TASK-USRCPUT-P1  = DS-PE-TASK-USRCPUT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TASK-USRCPUT-P2      TO TASK-USRCPUT-P2            R09039#
           COMPUTE TASK-USRDISPT-P1 = DS-PE-TASK-USRDISPT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-USRDISPT-P2     TO TASK-USRDISPT-P2           R09039#
           COMPUTE TASK-WTCEWAIT-P1 = DS-PE-TASK-WTCEWAIT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-WTCEWAIT-P2     TO TASK-WTCEWAIT-P2           R09039#
           COMPUTE TASK-WTEXWAIT-P1 = DS-PE-TASK-WTEXWAIT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TASK-WTEXWAIT-P2     TO TASK-WTEXWAIT-P2           R09039#
           MOVE DS-PE-TEMP-TSGETCT         TO TEMP-TSGETCT               R09039#
           COMPUTE TEMP-TSIOWTT-P1  = DS-PE-TEMP-TSIOWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TEMP-TSIOWTT-P2      TO TEMP-TSIOWTT-P2            R09039#
           MOVE DS-PE-TEMP-TSPUTACT        TO TEMP-TSPUTACT              R09039#
           MOVE DS-PE-TEMP-TSPUTMCT        TO TEMP-TSPUTMCT              R09039#
           COMPUTE TEMP-TSSHWAIT-P1 = DS-PE-TEMP-TSSHWAIT-P1 * 16 / K-1M R09039#
           MOVE DS-PE-TEMP-TSSHWAIT-P2     TO TEMP-TSSHWAIT-P2           R09039#
           MOVE DS-PE-TEMP-TSTOTCT         TO TEMP-TSTOTCT               R09039#
           COMPUTE TERM-IRIOWTT-P1  = DS-PE-TERM-IRIOWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TERM-IRIOWTT-P2      TO TERM-IRIOWTT-P2            R09039#
           COMPUTE TERM-LU61WTT-P1  = DS-PE-TERM-LU61WTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TERM-LU61WTT-P2      TO TERM-LU61WTT-P2            R09039#
           COMPUTE TERM-LU62WTT-P1  = DS-PE-TERM-LU62WTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TERM-LU62WTT-P2      TO TERM-LU62WTT-P2            R09039#
           MOVE DS-PE-TERM-LUNAME          TO TERM-LUNAME                R09039#
           MOVE DS-PE-TERM-NETID           TO TERM-NETID                 R09039#
           MOVE DS-PE-TERM-RLUNAME         TO TERM-RLUNAME               R09039#
           MOVE DS-PE-TERM-TCALLOCT        TO TERM-TCALLOCT              R09039#
           MOVE DS-PE-TERM-TCC62IN2        TO TERM-TCC62IN2              R09039#
           MOVE DS-PE-TERM-TCC62OU2        TO TERM-TCC62OU2              R09039#
           MOVE DS-PE-TERM-TCCHRIN1        TO TERM-TCCHRIN1              R09039#
           MOVE DS-PE-TERM-TCCHRIN2        TO TERM-TCCHRIN2              R09039#
           MOVE DS-PE-TERM-TCCHROU1        TO TERM-TCCHROU1              R09039#
           MOVE DS-PE-TERM-TCCHROU2        TO TERM-TCCHROU2              R09039#
           COMPUTE TERM-TCIOWTT-P1  = DS-PE-TERM-TCIOWTT-P1  * 16 / K-1M R09039#
           MOVE DS-PE-TERM-TCIOWTT-P2      TO TERM-TCIOWTT-P2            R09039#
           MOVE DS-PE-TERM-TCM62IN2        TO TERM-TCM62IN2              R09039#
           MOVE DS-PE-TERM-TCM62OU2        TO TERM-TCM62OU2              R09039#
           MOVE DS-PE-TERM-TCMSGIN1        TO TERM-TCMSGIN1              R09039#
           MOVE DS-PE-TERM-TCMSGIN2        TO TERM-TCMSGIN2              R09039#
           MOVE DS-PE-TERM-TCMSGOU1        TO TERM-TCMSGOU1              R09039#
           MOVE DS-PE-TERM-TCMSGOU2        TO TERM-TCMSGOU2              R09039#
           MOVE DS-PE-TERM-TERM            TO TERM-TERM                  R09039#
           IF DS-PE-TERM-TERM = LOW-VALUE                                R09039#
              MOVE SPACE                   TO TERM-TERM                  R09039#
           ELSE                                                          R09039#
              MOVE DS-PE-TERM-TERM         TO TERM-TERM                  R09039#
           END-IF                                                        R09039#
           MOVE DS-PE-TERM-TERMCNNM        TO TERM-TERMCNNM              R09039#
           MOVE DS-PE-TERM-TERMINFO        TO TERM-TERMINFO              R09039#
           MOVE TERM-TCIOWTT-P1            TO WAIT-TERM-TCIOWTT-P1       R09039#
           MOVE TERM-TCIOWTT-P2            TO WAIT-TERM-TCIOWTT-P2       R09039#
           MOVE JOUR-JCIOWTT-P1            TO WAIT-JOUR-JCIOWTT-P1       R09039#
           MOVE JOUR-JCIOWTT-P2            TO WAIT-JOUR-JCIOWTT-P2       R09039#
           MOVE TEMP-TSIOWTT-P1            TO WAIT-TEMP-TSIOWTT-P1       R09039#
           MOVE TEMP-TSIOWTT-P2            TO WAIT-TEMP-TSIOWTT-P2       R09039#
           MOVE FILE-FCIOWTT-P1            TO WAIT-FILE-FCIOWTT-P1       R09039#
           MOVE FILE-FCIOWTT-P2            TO WAIT-FILE-FCIOWTT-P2       R09039#
           MOVE TERM-IRIOWTT-P1            TO WAIT-TERM-IRIOWTT-P1       R09039#
           MOVE TERM-IRIOWTT-P2            TO WAIT-TERM-IRIOWTT-P2       R09039#
           MOVE DEST-TDIOWTT-P1            TO WAIT-DEST-TDIOWTT-P1       R09039#
           MOVE DEST-TDIOWTT-P2            TO WAIT-DEST-TDIOWTT-P2       R09039#
           MOVE TASK-GNQDELAY-P1           TO WAIT-TASK-GNQDELAY-P1      R09039#
           MOVE TASK-GNQDELAY-P2           TO WAIT-TASK-GNQDELAY-P2      R09039#
           MOVE TASK-LMDELAY-P1            TO WAIT-TASK-LMDELAY-P1       R09039#
           MOVE TASK-LMDELAY-P2            TO WAIT-TASK-LMDELAY-P2       R09039#
           MOVE TASK-ENQDELAY-P1           TO WAIT-TASK-ENQDELAY-P1      R09039#
           MOVE TASK-ENQDELAY-P2           TO WAIT-TASK-ENQDELAY-P2      R09039#
           MOVE TERM-LU61WTT-P1            TO WAIT-TERM-LU61WTT-P1       R09039#
           MOVE TERM-LU61WTT-P2            TO WAIT-TERM-LU61WTT-P2       R09039#
           MOVE TERM-LU62WTT-P1            TO WAIT-TERM-LU62WTT-P1       R09039#
           MOVE TERM-LU62WTT-P2            TO WAIT-TERM-LU62WTT-P2       R09039#
           MOVE DS-PE-FEPI-SZWAIT-P2       TO WAIT-FEPI-SZWAIT-P2        R09039#
           COMPUTE WAIT-FEPI-SZWAIT-P1 =                                 R09039#
                   DS-PE-FEPI-SZWAIT-P1 * K-1M                           R09039#
           MOVE TASK-RMISUSP-P1            TO WAIT-TASK-RMISUSP-P1       R09039#
           MOVE TASK-RMISUSP-P2            TO WAIT-TASK-RMISUSP-P2       R09039#
           MOVE FILE-RLSWAIT-P1            TO WAIT-FILE-RLSWAIT-P1       R09039#
           MOVE FILE-RLSWAIT-P2            TO WAIT-FILE-RLSWAIT-P2       R09039#
           MOVE FILE-CFDTWAIT-P1           TO WAIT-FILE-CFDTWAIT-P1      R09039#
           MOVE FILE-CFDTWAIT-P2           TO WAIT-FILE-CFDTWAIT-P2      R09039#
           MOVE SYNC-SRVSYWTT-P1           TO WAIT-SYNC-SRVSYWTT-P1      R09039#
           MOVE SYNC-SRVSYWTT-P2           TO WAIT-SYNC-SRVSYWTT-P2      R09039#
           MOVE TEMP-TSSHWAIT-P1           TO WAIT-TEMP-TSSHWAIT-P1      R09039#
           MOVE TEMP-TSSHWAIT-P2           TO WAIT-TEMP-TSSHWAIT-P2      R09039#
           MOVE TASK-WTEXWAIT-P1           TO WAIT-TASK-WTEXWAIT-P1      R09039#
           MOVE TASK-WTEXWAIT-P2           TO WAIT-TASK-WTEXWAIT-P2      R09039#
           MOVE TASK-WTCEWAIT-P1           TO WAIT-TASK-WTCEWAIT-P1      R09039#
           MOVE TASK-WTCEWAIT-P2           TO WAIT-TASK-WTCEWAIT-P2      R09039#
           MOVE TASK-ICDELAY-P1            TO WAIT-TASK-ICDELAY-P1       R09039#
           MOVE TASK-ICDELAY-P2            TO WAIT-TASK-ICDELAY-P2       R09039#
           MOVE TASK-GVUPWAIT-P1           TO WAIT-TASK-GVUPWAIT-P1      R09039#
           MOVE TASK-GVUPWAIT-P2           TO WAIT-TASK-GVUPWAIT-P2      R09039#
           MOVE DATA-IMSWAIT-P1            TO WAIT-DATA-IMSWAIT-P1       R09039#
           MOVE DATA-IMSWAIT-P2            TO WAIT-DATA-IMSWAIT-P2       R09039#
           MOVE DATA-DB2RDYQW-P1           TO WAIT-DATA-DB2RDYQW-P1      R09039#
           MOVE DATA-DB2RDYQW-P2           TO WAIT-DATA-DB2RDYQW-P2      R09039#
           MOVE DATA-DB2CONWT-P1           TO WAIT-DATA-DB2CONWT-P1      R09039#
           MOVE DATA-DB2CONWT-P2           TO WAIT-DATA-DB2CONWT-P2      R09039#
           MOVE DATA-DB2WAIT-P1            TO WAIT-DATA-DB2WAIT-P1       R09039#
           MOVE DATA-DB2WAIT-P2            TO WAIT-DATA-DB2WAIT-P2       R09039#
           MOVE TASK-RRMSWAIT-P1           TO WAIT-TASK-RRMSWAIT-P1      R09039#
           MOVE TASK-RRMSWAIT-P2           TO WAIT-TASK-RRMSWAIT-P2      R09039#
           MOVE TASK-RQRWAIT-P1            TO WAIT-TASK-RQRWAIT-P1       R09039#
           MOVE TASK-RQRWAIT-P2            TO WAIT-TASK-RQRWAIT-P2       R09039#
           MOVE TASK-RQPWAIT-P1            TO WAIT-TASK-RQPWAIT-P1       R09039#
           MOVE TASK-RQPWAIT-P2            TO WAIT-TASK-RQPWAIT-P2       R09039#
           MOVE TASK-RUNTRWTT-P1           TO WAIT-TASK-RUNTRWTT-P1      R09039#
           MOVE TASK-RUNTRWTT-P2           TO WAIT-TASK-RUNTRWTT-P2      R09039#
           MOVE SYNC-SYNCDLY-P1            TO WAIT-SYNC-SYNCDLY-P1       R09039#
           MOVE SYNC-SYNCDLY-P2            TO WAIT-SYNC-SYNCDLY-P2       R09039#
           MOVE SOCK-SOIOWTT-P1            TO WAIT-SOCK-SOIOWTT-P1       R09039#
           MOVE SOCK-SOIOWTT-P2            TO WAIT-SOCK-SOIOWTT-P2       R09039#
           MOVE TASK-MAXOTDLY-P1           TO WAIT-TASK-MAXOTDLY-P1      R09039#
           MOVE TASK-MAXOTDLY-P2           TO WAIT-TASK-MAXOTDLY-P2      R09039#
           MOVE TASK-SUSPTIME-P1           TO WAIT-TASK-SUSPTIME-P1      R09039#
           MOVE TASK-SUSPTIME-P2           TO WAIT-TASK-SUSPTIME-P2      R09039#
           MOVE TASK-MAXJTDLY-P1           TO WAIT-TASK-MAXJTDLY-P1      R09039#
           MOVE TASK-MAXJTDLY-P2           TO WAIT-TASK-MAXJTDLY-P2      R09039#
           MOVE TASK-MAXHTDLY-P1           TO WAIT-TASK-MAXHTDLY-P1      R09039#
           MOVE TASK-MAXHTDLY-P2           TO WAIT-TASK-MAXHTDLY-P2      R09039#
           MOVE TASK-PTPWAIT-P1            TO WAIT-TASK-PTPWAIT-P1       R09039#
           MOVE TASK-JVMSUSP-P1            TO WAIT-TASK-JVMSUSP-P1       R09039#
           MOVE TASK-JVMSUSP-P2            TO WAIT-TASK-JVMSUSP-P2       R09039#
           MOVE TASK-PTPWAIT-P2            TO WAIT-TASK-PTPWAIT-P2       R09039#
           MOVE SOCK-SOOIOWTT-P1           TO WAIT-SOCK-SOOIOWTT-P1      R09039#
           MOVE SOCK-SOOIOWTT-P2           TO WAIT-SOCK-SOOIOWTT-P2      R09039#
           COMPUTE WAIT-UPCAPTURE-TIME = WAIT-TASK-SUSPTIME-P1 - (       R09039#
                   WAIT-TERM-TCIOWTT-P1  + WAIT-TERM-LU61WTT-P1  +       R09039#
                   WAIT-JOUR-JCIOWTT-P1  + WAIT-TERM-LU62WTT-P1 +        R09039#
                   WAIT-TEMP-TSIOWTT-P1  + WAIT-FEPI-SZWAIT-P1 +         R09039#
                   WAIT-FILE-FCIOWTT-P1  + WAIT-TASK-RMISUSP-P1 +        R09039#
                   WAIT-TERM-IRIOWTT-P1  + WAIT-FILE-RLSWAIT-P1 +        R09039#
                   WAIT-DEST-TDIOWTT-P1  + WAIT-FILE-CFDTWAIT-P1 +       R09039#
                   WAIT-TASK-GNQDELAY-P1 + WAIT-SYNC-SRVSYWTT-P1 +       R09039#
                   WAIT-TASK-GNQDELAY-P2 + WAIT-TEMP-TSSHWAIT-P1 +       R09039#
                   WAIT-TASK-LMDELAY-P1  + WAIT-TASK-WTEXWAIT-P1 +       R09039#
                   WAIT-TASK-LMDELAY-P2  + WAIT-TASK-RQPWAIT-P1 +        R09039#
                   WAIT-TASK-ENQDELAY-P1 + WAIT-TASK-RUNTRWTT-P1 +       R09039#
                   WAIT-TASK-WTCEWAIT-P1 + WAIT-SYNC-SYNCDLY-P1 +        R09039#
                   WAIT-TASK-ICDELAY-P1  + WAIT-SOCK-SOIOWTT-P1 +        R09039#
                   WAIT-TASK-GVUPWAIT-P1 + WAIT-TASK-MAXOTDLY-P1 +       R09039#
                   WAIT-DATA-IMSWAIT-P1  + WAIT-TASK-JVMSUSP-P1 +        R09039#
                   WAIT-DATA-DB2RDYQW-P1 + WAIT-TASK-MAXJTDLY-P1 +       R09039#
                   WAIT-DATA-DB2CONWT-P1 + WAIT-TASK-MAXHTDLY-P1 +       R09039#
                   WAIT-DATA-DB2WAIT-P1  + WAIT-TASK-PTPWAIT-P1 +        R09039#
                   WAIT-TASK-RRMSWAIT-P1 + WAIT-SOCK-SOOIOWTT-P1  +      R09039#
                   WAIT-TASK-RQRWAIT-P1  )                               R09039#
                                                                         R09039#
      *    MOVE TASK-QRDISPT-P1            TO WAIT-TASK-QRDISPT-P1       R09039#
      *    MOVE TASK-QRDISPT-P2            TO WAIT-TASK-QRDISPT-P2       R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *============================*                                     R09039#
       E200-PRINT-MIN-REPORT.                                            R09039#
      *===========================*                                      R09039#
      *                                                                  R09039#
           IF WS-MIN-IND + 1 >= 64                                       R09039#
              PERFORM P100-PRINT-MIN-HEAD                                R09039#
           ELSE                                                          R09039#
              COMPUTE WS-MIN-REC-NO = WS-MIN-REC-NO + 1                  R09039#
              INITIALIZE SMF110-MIN-D1                                   R09039#
              MOVE TASK-TRAN                   TO SMF110-MIN-TRAN        R09039#
              IF TASK-TRAN = 'CSTP'                                      R09039#
                 MOVE SPACE                    TO SMF110-MIN-TX-NO       R09039#
              ELSE                                                       R09039#
                 MOVE TASK-TRANNUM             TO SMF110-MIN-TX-NO       R09039#
              END-IF                                                     R09039#
              IF TERM-TERM = LOW-VALUE                                   R09039#
                 MOVE SPACE                    TO SMF110-MIN-TEM         R09039#
              ELSE                                                       R09039#
                 MOVE TERM-TERM                TO SMF110-MIN-TEM         R09039#
              END-IF                                                     R09039#
              MOVE CICS-USERID                 TO SMF110-MIN-USER        R09039#
              MOVE TASK-TRANPRI                TO SMF110-MIN-PRTY        R09039#
              MOVE TASK-TTYPE                  TO SMF110-MIN-ST-TYPE     R09039#
              MOVE CICS-COST                   TO SMF110-MIN-RESP-TIME   R09039#
              MOVE CICS-START(9:2)            TO SMF110-MIN-ST-TME(1:2)  R09039#
              MOVE ':'                        TO SMF110-MIN-ST-TME(3:1)  R09039#
              MOVE CICS-START(11:2)           TO SMF110-MIN-ST-TME(4:2)  R09039#
              MOVE ':'                        TO SMF110-MIN-ST-TME(6:1)  R09039#
              MOVE CICS-START(13:2)           TO SMF110-MIN-ST-TME(7:2)  R09039#
              MOVE '.'                        TO SMF110-MIN-ST-TME(9:1)  R09039#
              MOVE CICS-START(15:6)           TO SMF110-MIN-ST-TME(10:6) R09039#
              MOVE CICS-STOP(9:2)             TO SMF110-MIN-ED-TME(1:2)  R09039#
              MOVE ':'                        TO SMF110-MIN-ED-TME(3:1)  R09039#
              MOVE CICS-STOP(11:2)            TO SMF110-MIN-ED-TME(4:2)  R09039#
              MOVE ':'                        TO SMF110-MIN-ED-TME(6:1)  R09039#
              MOVE CICS-STOP(13:2)            TO SMF110-MIN-ED-TME(7:2)  R09039#
              MOVE '.'                        TO SMF110-MIN-ED-TME(9:1)  R09039#
              MOVE CICS-STOP(15:6)            TO SMF110-MIN-ED-TME(10:6) R09039#
              MOVE TASK-SUSPTIME-P1            TO SMF110-MIN-SUSP-TIME   R09039#
              MOVE TASK-USRCPUT-P1             TO SMF110-MIN-CICS-TCB    R09039#
              MOVE PROG-PGMNAME                TO SMF110-MIN-INVOK-PGM   R09039#
              MOVE FILE-FCIOWTT-P1             TO SMF110-MIN-FIL-WT      R09039#
              MOVE FILE-FCIOWTT-P2             TO SMF110-MIN-FILE-NO     R09039#
              IF PROG-ABCODEC = SPACE                                    R09039#
                 MOVE PROG-ABCODEO             TO SMF110-MIN-ABEND       R09039#
              ELSE                                                       R09039#
                 MOVE PROG-ABCODEC             TO SMF110-MIN-ABEND       R09039#
              END-IF                                                     R09039#
              MOVE STOR-PCSTGHWM               TO SMF110-MIN-MAX-MEM     R09039#
              WRITE SMF110MN-RPT  FROM SMF110-MIN-D1 AFTER 1             R09039#
              ADD  1                           TO WS-MIN-IND             R09039#
           END-IF                                                        R09039#
           EXIT.                                                         R09039#
      *============================*                                     R09039#
       R100-READ-SMF110IN.                                               R09039#
      *===========================*                                      R09039#
      *                                                                  R09039#
           READ SMF110IN AT END SET K-END-FILE TO TRUE END-READ          R09039#
           IF WS-PRT-ST NOT = 00 AND WS-PRT-ST NOT = 10                  R09039#
             MOVE WS-SMFIN-ST                  TO WS-RETURN-CODE         R09039#
             DISPLAY 'READ SMFIN01 FILE FAIL=' WS-SMFIN-ST               R09039#
             PERFORM 9000-CHECK-RETURN-CODE    THRU 9000-EXIT            R09039#
           END-IF                                                        R09039#
           IF WS-PRT-ST = 10                                             R09039#
             DISPLAY ' EMPTY FILE '                                      R09039#
             PERFORM 9800-CLOSE-FILES                                    R09039#
           END-IF                                                        R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *============================*                                     R09039#
      *R200-WRITE-SMF110OP.                                              R09039#
      *===========================*                                      R09039#
      *                                                                  R09039#
      *    WRITE CICS-PE-GROUP                                           R09039#
      *    IF WS-SMFOUT-ST NOT = 00                                      R09039#
      *      DISPLAY 'WRITE SMF110OP FILE FAIL=' WS-SMFIN-ST             R09039#
      *      MOVE WS-SMFOUT-ST              TO WS-RETURN-CODE            R09039#
      *      PERFORM 9000-CHECK-RETURN-CODE THRU 9000-EXIT               R09039#
      *    END-IF.                                                       R09039#
      *    EXIT.                                                         R09039#
      *                                                                  R09039#
      *======================*                                           R09039#
       9000-CHECK-RETURN-CODE.                                           R09039#
      *======================*                                           R09039#
      *                                                                  R09039#
           IF WS-RETURN-CODE > 4 AND WS-RETURN-CODE NOT = 10             R09039#
           THEN                                                          R09039#
              MOVE WS-RETURN-CODE      TO RETURN-CODE                    R09039#
              PERFORM 9800-CLOSE-FILES  THRU 9800-EXIT                   R09039#
           ELSE                                                          R09039#
              IF WS-RETURN-CODE <= 4                                     R09039#
                 DISPLAY 'SMF110S1 WARNING'                              R09039#
                 IF WS-RETURN-CODE = 02                                  R09039#
                    DISPLAY 'SMF110S1 DUPLICATE KEY WAS DETECTED'        R09039#
                 END-IF                                                  R09039#
      *          IF WS-RETURN-CODE = 04                                  R09039#
      *          END-IF                                                  R09039#
                 DISPLAY 'SMF110S1 FILE LENGTH DID NOT CONFORM'          R09039#
                 DISPLAY 'RECORD POS IS:' WS-ALL-REC-NO                  R09039#
              ELSE                                                       R09039#
                 DISPLAY 'SMF110S1 NOW READ FILE TO END'                 R09039#
              END-IF                                                     R09039#
           END-IF                                                        R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       9000-EXIT.                                                        R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *====================*                                             R09039#
       P100-PRINT-MIN-HEAD.                                              R09039#
      *==============--====*                                             R09039#
      *                                                                  R09039#
           COMPUTE WS-MIN-PAGE-NO = WS-MIN-PAGE-NO + 1                   R09039#
           WRITE SMF110MN-RPT     FROM SMF110-MIN-T1 AFTER PAGE          R09039#
           MOVE 1                              TO WS-MIN-IND             R09039#
           MOVE WS-MIN-PAGE-NO                 TO RPT-PAGE-COUNT         R09039#
           WRITE SMF110MN-RPT     FROM SMF110-MIN-T2 AFTER 3             R09039#
           ADD     3                           TO WS-MIN-IND             R09039#
           WRITE SMF110MN-RPT     FROM SMF110-MIN-T3 AFTER 1             R09039#
           ADD     1                           TO WS-MIN-IND             R09039#
           WRITE SMF110MN-RPT     FROM SMF110-MIN-T4 AFTER 1             R09039#
           ADD     1                           TO WS-MIN-IND             R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *====================*                                             R09039#
       P200-PRINT-MIN-REMK.                                              R09039#
      *==============--====*                                             R09039#
      *                                                                  R09039#
           COMPUTE WS-I = 1                                              R09039#
           PERFORM UNTIL WS-I > (LENGTH OF K-MSG / 60)                   R09039#
             IF WS-MIN-IND + 1 >= 64                                     R09039#
                 COMPUTE WS-MIN-PAGE-NO = WS-MIN-PAGE-NO + 1             R09039#
                 WRITE SMF110MN-RPT FROM SMF110-MIN-T1 AFTER PAGE        R09039#
                 MOVE 1                        TO WS-MIN-IND             R09039#
                 MOVE WS-MIN-PAGE-NO           TO RPT-PAGE-COUNT         R09039#
                 WRITE SMF110MN-RPT FROM SMF110-MIN-T2 AFTER 3           R09039#
             End-if                                                      R09039#
             WRITE SMF110MN-RPT FROM K-MSG-A(WS-I) AFTER 1               R09039#
             COMPUTE WS-I = WS-I + 1                                     R09039#
           END-PERFORM.                                                  R09039#
      *                                                                  R09039#
      *====================*                                             R09039#
       P300-CHECK-GO-OR-SKIP.                                            R09039#
      *==============--====*                                             R09039#
      *                                                                  R09039#
            IF WS-SYS2-TRAN(1:1) = '*'                                   R09039#
               IF (DS-PE-TASK-TRAN(1:1) NOT = 'C') OR                    R09039#
                  (PER-CICS-YES AND DS-PE-TASK-TRAN(1:1) = 'C')          R09039#
               THEN                                                      R09039#
                  IF BEGIN-TIME >= WS-SYSIN3 AND                         R09039#
                     END-TIME <= WS-SYSIN4                               R09039#
                  THEN                                                   R09039#
TSTKDS*              DISPLAY ' WS GO                   '                 R09039#
                     SET WS-GO                          TO TRUE          R09039#
                  END-IF                                                 R09039#
               END-IF                                                    R09039#
            ELSE                                                         R09039#
               IF (((WS-SYS2-TRAN(1:WS-KEP-POS) =                        R09039#
                  DS-PE-TASK-TRAN(1:WS-KEP-POS)) AND WS-PATTERN-MOD)) OR R09039#
                 ((DS-PE-TASK-TRAN = WS-SYS2-TRAN) AND WS-FULL-MOD)      R09039#
               THEN                                                      R09039#
TSTKDS*              DISPLAY WS-SYSIN3 '::' WS-SYSIN4                    R09039#
                  IF BEGIN-TIME >= WS-SYSIN3 AND                         R09039#
                     END-TIME <= WS-SYSIN4                               R09039#
                  THEN                                                   R09039#
                     SET WS-GO                          TO TRUE          R09039#
                  END-IF                                                 R09039#
               END-IF                                                    R09039#
            END-IF                                                       R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       9800-CLOSE-FILES.                                                 R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           IF OPEN-SMF110IN-OK                                           R09039#
              CLOSE SMF110IN                                             R09039#
           END-IF                                                        R09039#
           IF OPEN-SMF110OP-OK                                           R09039#
              CLOSE SMF110OP                                             R09039#
           END-IF                                                        R09039#
           IF OPEN-SMF110MN-OK                                           R09039#
              CLOSE SMF110MN                                             R09039#
           END-IF                                                        R09039#
           PERFORM 9999-EXIT-PROG     THRU 9999-EXIT.                    R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       9800-EXIT.                                                        R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       9999-EXIT-PROG.                                                   R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           STOP RUN.                                                     R09039#
      *                                                                  R09039#
      *==================*                                               R09039#
       9999-EXIT.                                                        R09039#
      *==================*                                               R09039#
      *                                                                  R09039#
           EXIT.                                                         R09039#
      *                                                                  R09039#
